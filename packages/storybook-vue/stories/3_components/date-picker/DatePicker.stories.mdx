import { Meta, Story, ArgsTable, Canvas, Description } from "@storybook/addon-docs/blocks";
import ScaleDatePicker from "./ScaleDatePicker.vue";
import { action } from "@storybook/addon-actions";

<Meta
  title="Components/DatePicker"
  component={ScaleDatePicker}
  argTypes={{}}
/>

export const Template = (args, { argTypes }) => ({
  components: { ScaleDatePicker },
  props: ScaleDatePicker.props,
  template: `
    <div style="height: 380px;">
        <scale-date-picker
            :name="name"
            :identifier="identifier"
            :role="role"
            :direction="direction"
            :required="required"
            :min="min"
            :max="max"
            :first-day-of-week="firstDayOfWeek"
            :localization="localization"
            :date-adapter="dateAdapter"
            :value="value"
            :disabled="disabled"
            :label="label"
            :helper-text="helperText"
            :status="status"
            :size="size"
            @scaleChange="scaleChange"
            @scaleFocus="scaleFocus"
            @scaleBlur="scaleBlur"
            ></scale-date-picker>
    </div>
  `,
  methods: {
    scaleChange: function() {
      action('scaleChange')();
    },
    scaleFocus: function() {
      action('scaleFocus')();
    },
    scaleBlur: function() {
      action('scaleBlur')();
    },
  },
})


export const RangeTemplate = (args, { argTypes }) => ({
  components: { ScaleDatePicker },
  template: `
    <div style="height: 380px; display: inline-flex;">
        <scale-date-picker
            ref="start"
            identifier="start"
            label="Start"
            style="margin-right: 8px;"
            :value="$data.start"
            :max="$data.end"
            @scaleChange="scaleChangeStart"
        ></scale-date-picker>
        <scale-date-picker
            ref="end"
            identifier="end"
            label="End"
            :value="$data.end"
            :min="$data.start"
            @scaleChange="scaleChangeEnd"
        ></scale-date-picker>
    </div>
  `,
  methods: {
    scaleChangeStart: function(e) {
        this.$data.start = e.detail.value;
        setTimeout(() => {
            if(!this.$data.end) {
                this.$refs.end.$el.show()
            }
        }, 1000)
    },
    scaleChangeEnd: function(e) {
        this.$data.end = e.detail.value;
    },
  },
  data() {
    return {
        start: '',
        end: ''
    }
  },
})


# DatePicker

## Standard

<Canvas withSource="none">
  <Story
    name="Standard"
    args={{
        value: '2020-12-31',
        label: 'Standard'
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

<ArgsTable story="Standard" icon="SVG-PATH" />


```html
<scale-date-picker label="Standard" value="2020-12-31" @scaleChange="handleChange" @scaleFocus="handleFocus" @scaleBlur="handleBlur"></scale-date-picker>
```


## Helper Text

<Canvas withSource="none">
    <Story
        name="Helper Text"
        args={{
            value: '2020-12-31',
            label: "Helper Text",
            helperText: "Make sure to fill this",
        }}
    >
        {Template.bind({})}
    </Story>
</Canvas>


```html
<scale-date-picker helperText="Make sure to fill this" label="Helper Text" value="2020-12-31"></scale-date-picker>
```


## Small

<Canvas withSource="none">
    <Story
        name="Small"
        args={{
            value: '2020-12-31',
            label: "Small",
            size: "small"
        }}
    >
        {Template.bind({})}
    </Story>
</Canvas>


```html
<scale-date-picker label="Small" size="small" value="2020-12-31"></scale-date-picker>
```


## With Error

<Canvas withSource="none">
    <Story
        name="With Error"
        args={{
            label: "With Error",
            status: "error",
            helperText: "something is wrong",
        }}
    >
        {Template.bind({})}
    </Story>
</Canvas>


```html
<scale-date-picker label="With Error" helper-text="something is wrong" status="error" value="2020-12-31"></scale-date-picker>
```

## Disabled

<Canvas withSource="none">
    <Story
        name="Disabled"
        args={{
            label: "Disabled",
            disabled: true,
        }}
    >
        {Template.bind({})}
    </Story>
</Canvas>


```html
<scale-date-picker label="Disabled" disabled></scale-date-picker>
```

## Date Range Picker

<Canvas withSource="none">
    <Story
        name="Date Range Picker"
    >
        {RangeTemplate.bind({})}
    </Story>
</Canvas>


```js
const RangeTemplate = (args, { argTypes }) => ({
  components: { ScaleDatePicker },
  template: `
    <div style="height: 380px; display: inline-flex;">
        <scale-date-picker
            ref="start"
            identifier="start"
            label="Start"
            style="margin-right: 8px;"
            :value="$data.start"
            :max="$data.end"
            @scaleChange="scaleChangeStart"
        ></scale-date-picker>
        <scale-date-picker
            ref="end"
            identifier="end"
            label="End"
            :value="$data.end"
            :min="$data.start"
            @scaleChange="scaleChangeEnd"
        ></scale-date-picker>
    </div>
  `,
  methods: {
    scaleChangeStart: function(e) {
        this.$data.start = e.detail.value;
        setTimeout(() => {
            if(!this.$data.end) {
                this.$refs.end.$el.show()
            }
        }, 1000)
    },
    scaleChangeEnd: function(e) {
        this.$data.end = e.detail.value;
    },
  },
  data() {
    return {
        start: '',
        end: ''
    }
  },
})
```

```html
<duet-date-picker label="Start" identifier="startDate"></duet-date-picker>

<duet-date-picker label="End" identifier="endDate"></duet-date-picker>

<script>
  var startPicker = document.getElementById("startDate")
  var endPicker = document.getElementById("startDate")
  var startDate, endDate

  // When the start date picker is changed, set end date's min to equal date
  startPicker.addEventListener("duetChange", function(e) {
    startDate = e.detail.valueAsDate
    endPicker.min = e.detail.value

    if (!endDate) {
      endPicker.show()
    }
  })

  // When the end date picker is changed, set start date's max to equal date
  endPicker.addEventListener("duetChange", function(e) {
    endDate = e.detail.valueAsDate
    startPicker.max = e.detail.value
  })
</script>
```
